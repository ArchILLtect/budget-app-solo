import{u as n,j as o,M as N,l as D,p as R,q as _,r as z,V as x,t as p,B as S,v as F}from"./index-xwMjE7XY.js";import{r}from"./recharts-fUgtte1b.js";import{M as T}from"./modal-close-button-V6F9r3JT.js";import{S as q}from"./select-CEgIQikT.js";import{I as j}from"./input-QV5FdPZP.js";import"./use-form-control-B6IaQYr4.js";import"./split-CzYrjwZo.js";function J(){const i=n(e=>e.savingsGoals),C=n(e=>e.addSavingsGoal),t=n(e=>e.savingsReviewQueue),G=n(e=>e.addSavingsLog),w=n(e=>e.isSavingsModalOpen),M=n(e=>e.setConfirmModalOpen),O=n(e=>e.resolveSavingsLink),[d,c]=r.useState({}),[v,m]=r.useState({}),k=Object.values(v).some(Boolean),[u,g]=r.useState({});r.useEffect(()=>{const e={};t.forEach(a=>{if(a.name.toLowerCase().includes("yearly")){const s=i.find(h=>h.name.toLowerCase().includes("yearly"));s&&(e[a.id]=s.id)}}),c(e)},[t,i]);const B=(e,a)=>{a==="__newGoal"?(m(s=>({...s,[e]:!0})),c(s=>({...s,[e]:""}))):(m(s=>({...s,[e]:!1})),c(s=>({...s,[e]:a})))},E=e=>{const a=u[e],s=a?.name?.trim(),h=parseFloat(a?.target)||0;if(!s)return;const f=crypto.randomUUID();C({id:f,name:s,target:h}),c(l=>({...l,[e]:f})),m(l=>({...l,[e]:!1})),g(l=>({...l,[e]:{}}))},L=()=>{M(!0)},b=()=>{t.forEach(e=>{const a=d[e.id]||null;G(e.month,{goalId:a,date:e.date,amount:e.amount,name:e.name})}),O(!0)};return t.length?o.jsxs(N,{isOpen:w,onClose:L,closeOnOverlayClick:!0,closeOnEsc:!0,size:"xl",children:[o.jsx(D,{}),o.jsxs(R,{children:[o.jsx(_,{children:"Review Savings Transfers"}),o.jsx(T,{}),o.jsx(z,{children:o.jsx(x,{align:"stretch",spacing:4,children:t.map(e=>o.jsxs("div",{children:[o.jsxs(p,{children:[e.date," — $",e.amount.toFixed(2)," — ",e.name]}),o.jsxs(q,{placeholder:"Don't add to goal",value:d[e.id]||"",onChange:a=>B(e.id,a.target.value),children:[i.map(a=>o.jsx("option",{value:a.id,children:a.name},a.id)),o.jsx("option",{value:"__newGoal",children:"+ Create new goal…"})]}),v[e.id]&&o.jsxs(x,{mt:2,align:"stretch",spacing:2,children:[o.jsx(j,{placeholder:"New goal name",value:u[e.id]?.name||"",onChange:a=>g(s=>({...s,[e.id]:{...s[e.id],name:a.target.value}}))}),o.jsx(j,{placeholder:"Target amount",type:"number",value:u[e.id]?.target||"",onChange:a=>g(s=>({...s,[e.id]:{...s[e.id],target:a.target.value}}))}),o.jsx(S,{size:"sm",colorScheme:"teal",onClick:()=>E(e.id),children:"Save"})]}),o.jsxs(p,{fontSize:"sm",color:"gray.500",children:["Goal: ",d[e.id]?i.find(a=>a.id===d[e.id])?.name:"None"]})]},e.id))})}),o.jsx(F,{children:o.jsx(S,{colorScheme:"blue",onClick:b,isDisabled:k,children:"Confirm"})})]})]}):null}export{J as default};
